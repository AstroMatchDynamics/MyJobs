{% comment %}
form-error-highlight.html -- simple loop for displaying forms/modelforms.

Usese the following default django template tags:

hidden -- built in for all hidden form fields.
form -- the rest of the form.
{% endcomment %}
{% load widget_tweaks %}
{% load form_tags %}
{% load selection_boxes %}
<fieldset>
    {# Include but don't display hidden fields #}
    {% for hidden in form.hidden_fields %}
        {{ hidden}}
    {% endfor %}
    
    {% if form.errors %}
    {% for error in form.non_field_errors %}
    <p>{{error}}</p>
    {% endfor %}
    {% endif %}
    
    {# Include the visible fields #}
    {% for field in form.visible_fields %}
    {% is_boolean_field field as is_boolean %}
    {% is_select_field field as is_select %}
    {% if is_boolean or not form.only_show_required or form.only_show_required and field.field.required %}
        {# if it's an error put it in a red box #}
        {% if field.errors %}
        <div class="alert-message block-message error">
        {{ field.errors }}
        {% endif %}
        
        {% if form.auto_id %}
            <div class='form-label pull-left'>
                {{ field.label_tag }}
            </div>
            {{ field|attr:"placeholder:" }}
            {% elif is_select %}
            <div class="input-prepend" id="{{field.name}}_prependLabel">
            <span class="add-on">
                {{ field.label_tag }}
            </span>
            {{field}}
            </div>
            {% elif is_boolean %}
            {{field}}
            <div class="form-label pull-left checkbox-label">
                {{ field.label_tag }}
            </div>            
            {% elif 'country_code' in field.html_name %}
            {% with "id_"|add:form.prefix|add:"-country_sub_division_code" as region_id %}
            {% country_select selected="usa" html_id=field.id_for_label  region_html_id=region_id input_name=field.html_name %}
            {% endwith %}
            {% elif 'country_sub_division_code' in field.html_name %}
            {% region_select selected="" html_id=field.id_for_label input_name=field.html_name %}
            {% else %}
                {% if '_dialing' in field.html_name or field.html_name == "telephone-number" or field.html_name == "telephone-extension" %}
                    <div class="input-prepend" data-for="{{field.id}}">
                    <span class="add-on">
                        {{ field.label_tag }}
                    </span>
                    {{field}}
                    </div>
                {% else %}
                    {{ field  }}
                {% endif %}
            {% endif %}
            {% if field.help_text %}
            <span class="help-block">{{ field.help_text }}</span>
            {% endif %}
            {% if field.errors %}
            <div class="clear"></div>
        {% endif %}
        {% if field.errors %}
        </div>        
        {% endif %}
        <div class="clear"></div>
        {% endif %}
        {% endfor %}
</fieldset>
