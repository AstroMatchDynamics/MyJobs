{% extends 'postajob/form.html' %}
{% load i18n %}
{% load common_tags %}
{% gz as gz %}

{% block form %}
    <form action="?" method="post">
        {% csrf_token %}
        {{ form.owner }}
        <div class="accordion" id="accordions">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordions" href="#detail-body">
                        Job Details
                    </a>
                </div>
                <div id="detail-body" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        {% include 'includes/fieldset-error-highlight.html' with fieldset=form.get_field_sets.0 %}
                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordions" href="#location-body">
                        Job Locations
                    </a>
                </div>
                <div id="location-body" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        <fieldset>
                            {% for formset_form in formset %}
                                {% include 'includes/form-error-highlight.html' with form=formset_form %}
                            {% endfor %}
                            {{ formset.management_form }}
                        </fieldset>
                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordions" href="#instruction-body">
                        Application Instructions
                    </a>
                </div>
                <div id="instruction-body" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        {% include 'includes/fieldset-error-highlight.html' with fieldset=form.get_field_sets.1 %}
                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" href="#expiration-body">
                        Job Expiration
                    </a>
                </div>
                <div id="expiration-body" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        {% include 'includes/fieldset-error-highlight.html' with fieldset=form.get_field_sets.2 %}
                    </div>
                </div>
            </div>
        </div>
        <div class="actions">
            <div class="form-label pull-left">&nbsp;</div>
            {% if item.pk and not prevent_delete %}
                <button id="delete" type="button" data-toggle="modal" data-target="#delete-confirm" class="btn">{% trans 'Delete' %}</button>
                <div id="delete-confirm" class="modal hide fade row">
                    <div class="modal-header">{% trans 'Really Delete?' %}</div>
                    <div class="modal-body">{% blocktrans %}Are you sure you want to delete this {{verbose}}?{% endblocktrans %}</div>
                    <div class="modal-footer">
                        <div class="actions">
                            <button data-dismiss="modal" class="btn primary pull-right">{% trans 'Cancel' %}</button>
                            <a class="btn pull-right" href="{{ delete_url }}">{% trans 'Delete' %}</a>
                        </div>{# /actions #}
                    </div>{# /modal=footer #}
                </div>{# /delete-confirm #}
            {% endif %}
            <a href="{{ success_url }}" class="btn">{% trans 'Cancel' %}</a>
            <button type="submit" class="btn primary" id="profile-save">{% trans 'Save' %}</button>
        </div>{# /actions #}
    </form>
{% endblock form %}

{% block extra-js %}
    {{ block.super }}
    <script src="//d2e48ltfsb5exy.cloudfront.net/framework/v2/js/code/bootstrap-collapse.js{{ gz }}"></script>
    <script type="text/javascript">
        //$('.collapse').collapse({hide: true});
        var form_count = {{ formset.total_form_count }};
        var form = '{{ formset.empty_form|escapejs }}';
    </script>
{% endblock %}
