{% load user_ops %}
{% load common_tags %}

{% block extra_pages %}

<script>
jQuery(function(){
    If ({{ candidates_page}} < {{ previous }}) {
        jQuery('.endless_more').click();
    }
});
//$(document).ready(function()
//{
    //var x = 1
    //if (3 > x) {
        //var x = 1
        //while (x<3)
        //{
        //$("a.endless_more").trigger('click');
        //x++;
        //return false;
        //return false;
        //}        
    //}
    //var x = 2
    //while ({{ candidates_page}} < {{ previous }}) {
        //$("a.endless_more").trigger('click');
        
        
        //x++;   
        
        //return false;
        //return false;
    //};       
    //do {
 
        //$("a.endless_more").trigger('click');
        //x=x+1;
 
    //} while ( x<3 )
    //var x = 1;
    //if ({{ candidates_page}} < {{ previous }}) {
    //if (x<4) {
        //$("a.endless_more").trigger('click');
        //x++;
        //alert(x);
        //return false;
    //}   
//});
</script>

{% endblock %}

{% if candidates %}
                
    {% load endless %}    
    {% paginate 5 candidates %}    
                       
        <table id="row-link-table">  
            {% for candidate in candidates %}                    
            <tr class="hide-mobile" onclick="document.location = '{% url 'candidate_information' %}?company={{ company_id }}&user={{ candidate.user.id }}&anchor={{ forloop.counter }}&page={{ candidates_page }}&before={{ before|date:'m/d/Y' }}&after={{ after|date:'m/d/Y' }}';">
                <td>
                    <span class="gravatar pull-left">{% get_gravatar candidate.user '55' %}</span>                        
                </td>
                <td>
                    <div class="candidate-name">{{candidate.user|get_name_obj}}</div>
                    <a name="{{ forloop.counter }}"></a>
                    <a href="{% url 'candidate_information' %}?company={{ company_id }}&user={{ candidate.user.id }}&anchor={{ forloop.counter }}&page={{ candidates_page }}&before={{ before|date:'m/d/Y' }}&after={{ after|date:'m/d/Y' }}">{{candidate.user}}</a>
                    <div class="progress activity-progress">
                        <div class="bar bar-{% completion_level candidate.user.profile_completion %}" style="width: {{ candidate.user.profile_completion }}%"></div>
                    </div>
                </td>
                <td>
                    <strong>{% if candidate.label %}{{candidate.label}}{% else %}Unlabeled{% endif %}</strong><br>
                    {{candidate.url|url_domain}}<br>
                    {{candidate.created_on.date}}<br>
{{ candidates_page}}                    
                </td>
             </tr>
             <tr class="candidate-activity-mobile">
                <td>
                    <span class="gravatar pull-left">{% get_gravatar candidate.user '45' %}</span> 
                </td>
                <td>
                    <div class="candidate-name pull-left">{{candidate.user|get_name_obj}}</div>
                    <a href="{% url 'candidate_information' %}?company={{ company_id }}&user={{ candidate.user.id }}&before={{ before|date:'m/d/Y' }}&after={{ after|date:'m/d/Y' }}" class="candidate-activity-mobile pull-left">{{candidate.user}}</a>
                    <br>
                    <div class="progress activity-progress">
                        <div class="bar bar-{% completion_level candidate.user.profile_completion %}" style="width: {{ candidate.user.profile_completion }}%"></div>
                    </div>
                </td>
             <tr>
             {% endfor %}                    
         </table>
         
         {% show_more %}
         
         <script>
         /*Add btn classes to the endless paging links*/
         $(".endless_container a").addClass("btn");
         $(".endless_container .endless_loading").addClass("btn");
         </script>
{% else %}
    <div id="no-activity">
        <strong>There is no candidate activity between {{after.date}} and {{before.date}} for {{ site_name|cut:"http://" }}</strong>
    </div>
{% endif %}   
