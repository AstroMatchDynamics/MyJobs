{% extends "base.html" %}
{% load common_tags %}
{% load activity_tags %}
{% gz as gz %}

{% block site-title %}
    {% with name_obj=user.full_name %}
        <title>PRM Overview - {{ company.name }}</title>
        <meta name="title" content="PRM Overview - {{ company.name }}">
    {% endwith %}
{% endblock %}
{% load i18n %}

{% block content %}
    <h1><a href="{% url 'prm' %}">{{ company.name }}</a> {% if partner %}<small><a href="{% url 'partner_overview' %}?partner={{ partner.id }}">{{ partner.name }}</a></small>{% endif %}</h1>
    <div class="row">
        <div class="span12 prm-header">
            <span>Communication Records</span>
            <a class="mobile_hide" href="{% url 'partner_overview' %}?partner={{ partner.id }}">Back to Overview</a>
            <span class="pull-right" id="candidate-time-filter">{% include "mypartners/includes/date_range.html" %}</span>
        </div>
    </div>
    <div class="row">
        <div class="span12">
            <a class="btn" href="{% url 'partner_edit_record' %}?partner={{ partner.id }}" style="margin-bottom: 20px;">New Record</a>
            <div class="formBox no-padding profile-mobile" id="view-records">
                <h4>View Records</h4>
                {% if records %}
                <div class="formBox-content">
                    <div style="width: 330px;" class="span3 form-label pull-left initial">
                        <label for="record_contact" class="">Contact</label>
                    </div>
                    <div>
                        <select id="record_contact" name="record_contact">
                            {% for contact in contact_choices %}
                                <option value="{{ contact.0 }}">{{ contact.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div style="width: 330px;" class="span3 form-label pull-left initial">
                        <label for="record_contact_type" class="">Contact Type</label>
                    </div>
                    <div>
                        <select id="record_contact_type" name="record_contact_type">
                            {% for contact_type in contact_type_choices %}
                                <option value="{{ contact_type.0 }}">{{ contact_type.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                {% endif %}
                <table class="table table-bordered table-striped">
                    {% if records %}
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>Type</th>
                            <th>Contact</th>
                            <th>Subject</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    {% endif %}
                    {% get_record_block records company partner %}
                </table>
            </div>
        </div>
    </div>
    <div class="black-mask" style="display: none;"></div>
{% endblock %}

{% block extra-js %}
<script src="{{ STATIC_URL }}partner-overview.152-13.js{{ gz }}"></script>
<script src="{{ STATIC_URL }}record_overview.152-13.js{{ gz }}"></script>
<script src="{{ STATIC_URL }}partner-reports.153-09.js{{ gz }}"></script>
<script>
    var company_id = {{ company.id }};
    var partner_id = {{ partner.id }};
    var admin_id = {% if admin_id %}{{ admin_id }}{% else %}'None'{% endif %};
</script>
{% endblock %}