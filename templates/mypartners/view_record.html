{% extends "base.html" %}
{% load activity_tags %}
{% load i18n %}

{% block site-title %}
    <title>PRM Contact Record {{ company.name }}</title>
    <meta name="title" content="PRM Contact Record {{ company.name }}">
{% endblock %}

{% block content %}
    <h1><a href="{% url 'prm' %}?company={{ company.id }}">{{ company.name }}</a> {% if partner %}<small><a href="{% url 'partner_overview' %}?company={{ company.id }}&partner={{ partner.id }}">{{ partner.name }}</a></small>{% endif %}</h1>
    <div class="row">
        <div class="span12 prm-header">
            <span>{% if record.subject %}{{ record.subject }} - {% endif %}{{ record.date_time|date:'M d, Y' }} </span>
            <a href="{% url "record_view" %}?company={{ company.id }}&partner={{ partner.id }}">Back to Communication Records</a>
            <span class="pull-right">
                {% if prev_id %}
                    <a href="{% url 'record_view' %}?company={{ company.id }}&partner={{ partner.id }}&id={{ prev_id }}&offset={{ prev_offset }}{% if contact_name %}&name={{ contact_name }}{% endif %}{%if contact_type %}&type={{ contact_type }}{% endif %}">Previous</a>&nbsp;&nbsp;
                {% endif %}
                {% if next_id %}
                    <a href="{% url 'record_view' %}?company={{ company.id }}&partner={{ partner.id }}&id={{ next_id }}&offset={{ next_offset }}{% if contact_name %}&name={{ contact_name }}{% endif %}{%if contact_type %}&type={{ contact_type }}{% endif %}">Next</a>&nbsp;&nbsp;
                {% endif %}
            </span>
        </div>
    </div>

    <div class="row">
        <div class="span3">
            <div class="tip-box" id="details">
            <h5>Contact Details</h5>
                <div class="tip-content">
                {{ record.contact_name }} <br/>
                {% if record.contact_email %}{{ record.contact_email }}<br/>{% endif %}
                {% if record.contact_phone %}{{ record.contact_phone }}<br/>{% endif %}
                </div>
            </div>
            {% if record.subject %}
            <div class="tip-box" id="subject">
            <h5>Subject</h5>
                <div class="tip-content">
                    {{ record.subject }}
                </div>
            </div>
            {% endif %}
            <div class="tip-box" id="type">
            <h5>Contact Type</h5>
                <div class="tip-content">
                    {% get_contact_type record %}
                </div>
            </div>
            <div class="tip-box" id="time">
            <h5>Date & Time of Contact</h5>
                <div class="tip-content">
                    {{ record.date_time }}
                </div>
            </div>
            {% if attachments %}
            <div class="tip-box" id="attachments">
            <h5>Attachments</h5>
                <div class="tip-content">
                {% for attachment in attachments %}
                    {% attachment_link attachment partner company %}<br/>
                {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
        <div class="span6">
            <div class="tip-box" id="notes">
            <h5>Details, Notes or Transcript</h5>
                <div class="tip-content">
                    {% if record.notes %}
                    {{ record.notes }}
                    {% else %}
                    There are no notes for this record.
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="span3">
            <a class="btn one-hundred-percent-button-border-boxed" href="{% url 'partner_edit_record' %}?company={{ company.id }}&partner={{ partner.id }}&id={{ record.id }}">Edit</a>
            <div class="tip-box" id="record-history">
            <h5>Record History</h5>
                <div class="tip-content">
                    {% if not record_history %}
                    No history for this record could be found.
                    {% else %}
                        {% for activity in record_history %}
                            {% get_action_type activity %} - {{ activity.action_time|date:'M d, Y' }}<br/>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock content %}